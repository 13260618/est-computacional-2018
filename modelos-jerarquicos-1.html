<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>13-Modelos jerárquicos | Estadística Computacional</title>
  <meta name="description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2018.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="13-Modelos jerárquicos | Estadística Computacional />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2018." />
  <meta name="github-repo" content="tereom/est-computacional-2018" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="13-Modelos jerárquicos | Estadística Computacional />
  
  <meta name="twitter:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2018." />
  

<meta name="author" content="María Teresa Ortiz">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="mcmc-convergencia.html">
<link rel="next" href="referencias.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.5/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.5/profvis.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.5/profvis.js"></script>
<script src="libs/plotly-binding-4.8.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.39.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.39.2/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
<link rel="stylesheet" href="css/font-awesome.min.css" type="text/css" />
<link rel="stylesheet" href="css/cajas.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Estadística Computacional</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Información del curso</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html"><i class="fa fa-check"></i>Temario</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#calificacion"><i class="fa fa-check"></i>Calificación</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#software"><i class="fa fa-check"></i>Software</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#otros-recursos"><i class="fa fa-check"></i>Otros recursos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduccion-a-visualizacion.html"><a href="introduccion-a-visualizacion.html"><i class="fa fa-check"></i><b>1</b> Introducción a visualización</a><ul>
<li class="chapter" data-level="" data-path="introduccion-a-visualizacion.html"><a href="introduccion-a-visualizacion.html#el-cuarteto-de-ascombe"><i class="fa fa-check"></i>El cuarteto de Ascombe</a></li>
<li class="chapter" data-level="1.1" data-path="introduccion.html"><a href="introduccion.html"><i class="fa fa-check"></i><b>1.1</b> Introducción</a><ul>
<li class="chapter" data-level="" data-path="introduccion.html"><a href="introduccion.html#visualizacion-de-datos-en-la-estadistica"><i class="fa fa-check"></i>Visualización de datos en la estadística</a></li>
<li class="chapter" data-level="" data-path="introduccion.html"><a href="introduccion.html#visualizacion-popular-de-datos"><i class="fa fa-check"></i>Visualización popular de datos</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html"><i class="fa fa-check"></i><b>1.2</b> Teoría de visualización de datos</a><ul>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#principios-generales-del-diseno-analitico"><i class="fa fa-check"></i>Principios generales del diseño analítico</a></li>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#tecnicas-de-visualizacion"><i class="fa fa-check"></i>Técnicas de visualización</a></li>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#indicadores-de-calidad-grafica"><i class="fa fa-check"></i>Indicadores de calidad gráfica</a></li>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#factor-de-engano-chartjunk-y-pies"><i class="fa fa-check"></i>Factor de engaño, chartjunk y pies</a></li>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#series-de-tiempo-y-promedio-de-45"><i class="fa fa-check"></i>Series de tiempo y promedio de 45</a></li>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#pequenos-multiplos-y-densidad-grafica"><i class="fa fa-check"></i>Pequeños múltiplos y densidad gráfica</a></li>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#tinta-de-datos"><i class="fa fa-check"></i>Tinta de datos</a></li>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#percepcion-de-escala"><i class="fa fa-check"></i>Percepción de escala</a></li>
<li class="chapter" data-level="" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html#minard"><i class="fa fa-check"></i>Minard</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduccion-a-r-y-al-paquete-ggplot2.html"><a href="introduccion-a-r-y-al-paquete-ggplot2.html"><i class="fa fa-check"></i><b>2</b> Introducción a R y al paquete ggplot2</a><ul>
<li class="chapter" data-level="2.1" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html"><i class="fa fa-check"></i><b>2.1</b> R: primeros pasos</a><ul>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#r-en-analisis-de-datos"><i class="fa fa-check"></i>R en análisis de datos</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#paquetes-y-el-tidyverse"><i class="fa fa-check"></i>Paquetes y el Tidyverse</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#recursos"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="visualizacion-con-ggplot2.html"><a href="visualizacion-con-ggplot2.html"><i class="fa fa-check"></i><b>2.2</b> Visualización con ggplot2</a><ul>
<li class="chapter" data-level="" data-path="visualizacion-con-ggplot2.html"><a href="visualizacion-con-ggplot2.html#recursos-1"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manipulacion-y-agrupacion-de-datos.html"><a href="manipulacion-y-agrupacion-de-datos.html"><i class="fa fa-check"></i><b>3</b> Manipulación y agrupación de datos</a><ul>
<li class="chapter" data-level="3.1" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html"><i class="fa fa-check"></i><b>3.1</b> Transformación de datos</a><ul>
<li><a href="transformacion-de-datos.html#separa-aplica-combina-split-apply-combine">Separa-aplica-combina (<em>split-apply-combine</em>)</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#ejemplos-y-lectura-de-datos"><i class="fa fa-check"></i>Ejemplos y lectura de datos</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#filtrar"><i class="fa fa-check"></i>Filtrar</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#seleccionar"><i class="fa fa-check"></i>Seleccionar</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#ordenar"><i class="fa fa-check"></i>Ordenar</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#mutar"><i class="fa fa-check"></i>Mutar</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#summarise-y-resumenes-por-grupo"><i class="fa fa-check"></i>Summarise y resúmenes por grupo</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#operador-pipeline"><i class="fa fa-check"></i>Operador pipeline</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#variables-por-grupo"><i class="fa fa-check"></i>Variables por grupo</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#verbos-de-dos-tablas"><i class="fa fa-check"></i>Verbos de dos tablas</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="datos-limpios.html"><a href="datos-limpios.html"><i class="fa fa-check"></i><b>3.2</b> Datos limpios</a><ul>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#limpieza-bases-de-datos"><i class="fa fa-check"></i>Limpieza bases de datos</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#los-encabezados-de-las-columanas-son-valores"><i class="fa fa-check"></i>Los encabezados de las columanas son valores</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-columna-asociada-a-mas-de-una-variable"><i class="fa fa-check"></i>Una columna asociada a más de una variable</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#variables-almacenadas-en-filas-y-columnas"><i class="fa fa-check"></i>Variables almacenadas en filas y columnas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#mas-de-un-tipo-de-observacion-en-una-misma-tabla"><i class="fa fa-check"></i>Mas de un tipo de observación en una misma tabla</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-misma-unidad-observacional-esta-almacenada-en-multiples-tablas"><i class="fa fa-check"></i>Una misma unidad observacional está almacenada en múltiples tablas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#otras-consideraciones"><i class="fa fa-check"></i>Otras consideraciones</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#recursos-adicionales"><i class="fa fa-check"></i>Recursos adicionales</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="temas-selectos-de-r.html"><a href="temas-selectos-de-r.html"><i class="fa fa-check"></i><b>4</b> Temas selectos de R</a><ul>
<li class="chapter" data-level="4.1" data-path="funciones.html"><a href="funciones.html"><i class="fa fa-check"></i><b>4.1</b> Funciones</a><ul>
<li class="chapter" data-level="" data-path="funciones.html"><a href="funciones.html#estructura-de-una-funcion"><i class="fa fa-check"></i>Estructura de una función</a></li>
<li class="chapter" data-level="" data-path="funciones.html"><a href="funciones.html#observaciones-del-uso-de-funciones"><i class="fa fa-check"></i>Observaciones del uso de funciones</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="vectores.html"><a href="vectores.html"><i class="fa fa-check"></i><b>4.2</b> Vectores</a><ul>
<li class="chapter" data-level="" data-path="vectores.html"><a href="vectores.html#propiedades"><i class="fa fa-check"></i>Propiedades</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="iteracion.html"><a href="iteracion.html"><i class="fa fa-check"></i><b>4.3</b> Iteración</a></li>
<li class="chapter" data-level="4.4" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html"><i class="fa fa-check"></i><b>4.4</b> Rendimiento en R</a><ul>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#diagnosticar"><i class="fa fa-check"></i>Diagnosticar</a></li>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#estrategias-para-mejorar-desempeno"><i class="fa fa-check"></i>Estrategias para mejorar desempeño</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduccion-a-probabilidad.html"><a href="introduccion-a-probabilidad.html"><i class="fa fa-check"></i><b>5</b> Introducción a probabilidad</a><ul>
<li class="chapter" data-level="5.1" data-path="probabilidad-como-extension-a-proporcion.html"><a href="probabilidad-como-extension-a-proporcion.html"><i class="fa fa-check"></i><b>5.1</b> Probabilidad como extensión a proporción</a></li>
<li class="chapter" data-level="5.2" data-path="interpretacion-frecuentista-de-probabilidad.html"><a href="interpretacion-frecuentista-de-probabilidad.html"><i class="fa fa-check"></i><b>5.2</b> Interpretación frecuentista de probabilidad</a></li>
<li class="chapter" data-level="5.3" data-path="simulacion-para-el-calculo-de-probabilidades.html"><a href="simulacion-para-el-calculo-de-probabilidades.html"><i class="fa fa-check"></i><b>5.3</b> Simulación para el cálculo de probabilidades</a></li>
<li class="chapter" data-level="5.4" data-path="probabilidad-definicion-matematica.html"><a href="probabilidad-definicion-matematica.html"><i class="fa fa-check"></i><b>5.4</b> Probabilidad: definición matemática</a><ul>
<li class="chapter" data-level="5.4.1" data-path="probabilidad-definicion-matematica.html"><a href="probabilidad-definicion-matematica.html#propiedades-de-la-funcion-de-probabilidad"><i class="fa fa-check"></i><b>5.4.1</b> Propiedades de la función de probabilidad:</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html"><i class="fa fa-check"></i><b>5.5</b> Variables aleatorias</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bootstrap-no-parametrico.html"><a href="bootstrap-no-parametrico.html"><i class="fa fa-check"></i><b>6</b> Bootstrap no paramétrico</a><ul>
<li class="chapter" data-level="6.1" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html"><i class="fa fa-check"></i><b>6.1</b> El principio del plug-in</a><ul>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#muestras-aleatorias"><i class="fa fa-check"></i>Muestras aleatorias</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#funcion-de-distribucion-empirica"><i class="fa fa-check"></i>Función de distribución empírica</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#parametros-y-estadisticas"><i class="fa fa-check"></i>Parámetros y estadísticas</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#distribuciones-muestrales-y-errores-estandar"><i class="fa fa-check"></i>Distribuciones muestrales y errores estándar</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="el-estimador-bootstrap-del-error-estandar.html"><a href="el-estimador-bootstrap-del-error-estandar.html"><i class="fa fa-check"></i><b>6.2</b> El estimador bootstrap del error estándar</a><ul>
<li class="chapter" data-level="" data-path="el-estimador-bootstrap-del-error-estandar.html"><a href="el-estimador-bootstrap-del-error-estandar.html#variacion-en-distribuciones-bootstrap"><i class="fa fa-check"></i>Variación en distribuciones bootstrap</a></li>
<li class="chapter" data-level="" data-path="el-estimador-bootstrap-del-error-estandar.html"><a href="el-estimador-bootstrap-del-error-estandar.html#mas-alla-de-muestras-aleatorias-simples"><i class="fa fa-check"></i>Más alla de muestras aleatorias simples</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html"><i class="fa fa-check"></i><b>6.3</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="6.4" data-path="bootstrap-en-r.html"><a href="bootstrap-en-r.html"><i class="fa fa-check"></i><b>6.4</b> Bootstrap en R</a></li>
<li class="chapter" data-level="6.5" data-path="conclusiones-y-observaciones.html"><a href="conclusiones-y-observaciones.html"><i class="fa fa-check"></i><b>6.5</b> Conclusiones y observaciones</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="teoria-basica-de-simulacion.html"><a href="teoria-basica-de-simulacion.html"><i class="fa fa-check"></i><b>7</b> Teoría básica de simulación</a><ul>
<li class="chapter" data-level="7.1" data-path="numeros-pseudoaleatorios.html"><a href="numeros-pseudoaleatorios.html"><i class="fa fa-check"></i><b>7.1</b> Números pseudoaleatorios</a><ul>
<li class="chapter" data-level="" data-path="numeros-pseudoaleatorios.html"><a href="numeros-pseudoaleatorios.html#generadores-congruenciales-y-mersenne-twister"><i class="fa fa-check"></i>Generadores congruenciales y Mersenne-Twister</a></li>
<li class="chapter" data-level="" data-path="numeros-pseudoaleatorios.html"><a href="numeros-pseudoaleatorios.html#pruebas-de-aleatoriedad"><i class="fa fa-check"></i>Pruebas de aleatoriedad</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html"><i class="fa fa-check"></i><b>7.2</b> Variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html#familias-discretas-importantes"><i class="fa fa-check"></i>Familias discretas importantes</a></li>
<li class="chapter" data-level="" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html#familias-continuas-importantes"><i class="fa fa-check"></i>Familias Continuas importantes</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="simulacion-de-variables-aleatorias.html"><a href="simulacion-de-variables-aleatorias.html"><i class="fa fa-check"></i><b>7.3</b> Simulación de variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="simulacion-de-variables-aleatorias.html"><a href="simulacion-de-variables-aleatorias.html#variables-aletaorias-discretas"><i class="fa fa-check"></i>Variables aletaorias discretas</a></li>
<li class="chapter" data-level="" data-path="simulacion-de-variables-aleatorias.html"><a href="simulacion-de-variables-aleatorias.html#aceptacion-y-rechazo"><i class="fa fa-check"></i>Aceptación y rechazo</a></li>
<li class="chapter" data-level="" data-path="simulacion-de-variables-aleatorias.html"><a href="simulacion-de-variables-aleatorias.html#variables-aleatorias-continuas-1"><i class="fa fa-check"></i>Variables aleatorias continuas</a></li>
<li class="chapter" data-level="" data-path="simulacion-de-variables-aleatorias.html"><a href="simulacion-de-variables-aleatorias.html#aceptacion-y-rechazo-1"><i class="fa fa-check"></i>Aceptación y rechazo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulacion-de-modelos.html"><a href="simulacion-de-modelos.html"><i class="fa fa-check"></i><b>8</b> Simulación de modelos</a><ul>
<li class="chapter" data-level="" data-path="simulacion-de-modelos.html"><a href="simulacion-de-modelos.html#para-que-simular-de-un-modelo"><i class="fa fa-check"></i>¿Para qué simular de un modelo?</a></li>
<li class="chapter" data-level="8.1" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html"><i class="fa fa-check"></i><b>8.1</b> Distribuciones multivariadas</a><ul>
<li class="chapter" data-level="" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#regla-de-bayes"><i class="fa fa-check"></i>Regla de Bayes</a></li>
<li class="chapter" data-level="" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#independencia"><i class="fa fa-check"></i>Independencia</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="modelos-graficos-y-simulacion-predictiva.html"><a href="modelos-graficos-y-simulacion-predictiva.html"><i class="fa fa-check"></i><b>8.2</b> Modelos gráficos y simulación predictiva</a></li>
<li class="chapter" data-level="8.3" data-path="inferencia-visual.html"><a href="inferencia-visual.html"><i class="fa fa-check"></i><b>8.3</b> Inferencia visual</a><ul>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#inferencia"><i class="fa fa-check"></i>Inferencia</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#protocolos-de-inferencia-visual"><i class="fa fa-check"></i>Protocolos de inferencia visual</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#pruebas-de-hipotesis-tipicas"><i class="fa fa-check"></i>Pruebas de hipótesis típicas</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#inferencia-visual-1"><i class="fa fa-check"></i>Inferencia visual</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#mas-alla-que-permutacion"><i class="fa fa-check"></i>Más allá que permutación</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#otras-consideraciones-1"><i class="fa fa-check"></i>Otras consideraciones</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="simulacion-para-calculo-de-tamano-de-muestrapoder-estadistico.html"><a href="simulacion-para-calculo-de-tamano-de-muestrapoder-estadistico.html"><i class="fa fa-check"></i><b>8.4</b> Simulación para cálculo de tamaño de muestra/poder estadístico</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="inferencia-parametrica.html"><a href="inferencia-parametrica.html"><i class="fa fa-check"></i><b>9</b> Inferencia paramétrica</a><ul>
<li class="chapter" data-level="9.1" data-path="maxima-verosimilitud.html"><a href="maxima-verosimilitud.html"><i class="fa fa-check"></i><b>9.1</b> Máxima verosimilitud</a><ul>
<li class="chapter" data-level="" data-path="maxima-verosimilitud.html"><a href="maxima-verosimilitud.html#propiedades-de-los-estimadores-de-maxima-verosimilitud"><i class="fa fa-check"></i>Propiedades de los estimadores de máxima verosimilitud</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="bootstrap-parametrico.html"><a href="bootstrap-parametrico.html"><i class="fa fa-check"></i><b>9.2</b> Bootstrap paramétrico</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="analisis-bayesiano.html"><a href="analisis-bayesiano.html"><i class="fa fa-check"></i><b>10</b> Análisis bayesiano</a><ul>
<li class="chapter" data-level="10.1" data-path="probabilidad-subjetiva.html"><a href="probabilidad-subjetiva.html"><i class="fa fa-check"></i><b>10.1</b> Probabilidad subjetiva</a></li>
<li class="chapter" data-level="10.2" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html"><i class="fa fa-check"></i><b>10.2</b> Regla de Bayes e inferencia bayesiana</a><ul>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#regla-de-bayes-en-modelos-y-datos"><i class="fa fa-check"></i>Regla de Bayes en modelos y datos</a></li>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#objetivos-de-la-inferencia"><i class="fa fa-check"></i>Objetivos de la inferencia</a></li>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#calculo-de-la-distribucion-posterior"><i class="fa fa-check"></i>Cálculo de la distribución posterior</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="distribuciones-conjugadas.html"><a href="distribuciones-conjugadas.html"><i class="fa fa-check"></i><b>10.3</b> Distribuciones conjugadas</a><ul>
<li class="chapter" data-level="" data-path="distribuciones-conjugadas.html"><a href="distribuciones-conjugadas.html#ejemplo-bernoulli"><i class="fa fa-check"></i>Ejemplo: Bernoulli</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="aproximacion-por-cuadricula.html"><a href="aproximacion-por-cuadricula.html"><i class="fa fa-check"></i><b>10.4</b> Aproximación por cuadrícula</a></li>
<li class="chapter" data-level="10.5" data-path="mcmc.html"><a href="mcmc.html"><i class="fa fa-check"></i><b>10.5</b> MCMC</a><ul>
<li class="chapter" data-level="" data-path="mcmc.html"><a href="mcmc.html#introduccion-metropolis"><i class="fa fa-check"></i>Introducción Metrópolis</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="metropolis.html"><a href="metropolis.html"><i class="fa fa-check"></i><b>10.6</b> Metrópolis</a><ul>
<li class="chapter" data-level="" data-path="metropolis.html"><a href="metropolis.html#inferencia-de-dos-proporciones-binomiales"><i class="fa fa-check"></i>Inferencia de dos proporciones binomiales</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="muestreador-de-gibbs.html"><a href="muestreador-de-gibbs.html"><i class="fa fa-check"></i><b>10.7</b> Muestreador de Gibbs</a><ul>
<li class="chapter" data-level="" data-path="muestreador-de-gibbs.html"><a href="muestreador-de-gibbs.html#conclusiones-y-observaciones-metropolis-y-gibbs"><i class="fa fa-check"></i>Conclusiones y observaciones Metrópolis y Gibbs</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="jags.html"><a href="jags.html"><i class="fa fa-check"></i><b>10.8</b> JAGS</a><ul>
<li class="chapter" data-level="" data-path="jags.html"><a href="jags.html#ejemplo-normal-1"><i class="fa fa-check"></i>Ejemplo normal</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="diagnosticos.html"><a href="diagnosticos.html"><i class="fa fa-check"></i><b>10.9</b> Diagnósticos</a><ul>
<li class="chapter" data-level="" data-path="diagnosticos.html"><a href="diagnosticos.html#recomendaciones-generales"><i class="fa fa-check"></i>Recomendaciones generales</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html"><i class="fa fa-check"></i><b>10.10</b> HMC y Stan</a><ul>
<li class="chapter" data-level="" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html#muestreo-hmc"><i class="fa fa-check"></i>Muestreo HMC</a></li>
<li class="chapter" data-level="" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html#iniciales"><i class="fa fa-check"></i>Iniciales</a></li>
<li class="chapter" data-level="" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html#recursos-adicionales-de-stan"><i class="fa fa-check"></i>Recursos adicionales de Stan</a></li>
</ul></li>
<li class="chapter" data-level="10.11" data-path="modelos-jerarquicos.html"><a href="modelos-jerarquicos.html"><i class="fa fa-check"></i><b>10.11</b> Modelos jerárquicos</a><ul>
<li class="chapter" data-level="" data-path="modelos-jerarquicos.html"><a href="modelos-jerarquicos.html#modelo-jerarquico-una-moneda"><i class="fa fa-check"></i>Modelo jerárquico una moneda</a></li>
<li class="chapter" data-level="" data-path="modelos-jerarquicos.html"><a href="modelos-jerarquicos.html#multiples-monedas-de-una-misma-fabrica"><i class="fa fa-check"></i>Multiples monedas de una misma fábrica</a></li>
<li class="chapter" data-level="" data-path="modelos-jerarquicos.html"><a href="modelos-jerarquicos.html#ejemplo-estimacion-de-tasas-de-mortalidad"><i class="fa fa-check"></i>Ejemplo: estimación de tasas de mortalidad</a></li>
<li class="chapter" data-level="" data-path="modelos-jerarquicos.html"><a href="modelos-jerarquicos.html#ejemplo-conteo-rapido"><i class="fa fa-check"></i>Ejemplo: conteo rápido</a></li>
</ul></li>
<li class="chapter" data-level="10.12" data-path="flujo-de-trabajo-para-el-analisis-bayesiano.html"><a href="flujo-de-trabajo-para-el-analisis-bayesiano.html"><i class="fa fa-check"></i><b>10.12</b> Flujo de trabajo para el análisis bayesiano</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html"><i class="fa fa-check"></i>Tareas</a><ul>
<li class="chapter" data-level="" data-path="transformacion-de-datos-1.html"><a href="transformacion-de-datos-1.html"><i class="fa fa-check"></i>2-Transformación de datos</a></li>
<li class="chapter" data-level="" data-path="datos-limpios-1.html"><a href="datos-limpios-1.html"><i class="fa fa-check"></i>3-Datos Limpios</a></li>
<li class="chapter" data-level="" data-path="probabilidad.html"><a href="probabilidad.html"><i class="fa fa-check"></i>4-Probabilidad</a></li>
<li class="chapter" data-level="" data-path="bootstrap.html"><a href="bootstrap.html"><i class="fa fa-check"></i>5-Bootstrap</a><ul>
<li class="chapter" data-level="" data-path="bootstrap.html"><a href="bootstrap.html#solucion"><i class="fa fa-check"></i>Solución</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cobertura-de-intervalos-de-confianza.html"><a href="cobertura-de-intervalos-de-confianza.html"><i class="fa fa-check"></i>6-Cobertura de intervalos de confianza</a><ul>
<li class="chapter" data-level="" data-path="cobertura-de-intervalos-de-confianza.html"><a href="cobertura-de-intervalos-de-confianza.html#solucion-1"><i class="fa fa-check"></i>Solución</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="simulacion-de-modelos-1.html"><a href="simulacion-de-modelos-1.html"><i class="fa fa-check"></i>7-Simulación de modelos</a></li>
<li class="chapter" data-level="" data-path="simulacion-de-modelos-de-regresion.html"><a href="simulacion-de-modelos-de-regresion.html"><i class="fa fa-check"></i>8-Simulación de modelos de regresión</a></li>
<li class="chapter" data-level="" data-path="inferencia-grafica-tamano-de-muestra-bootstrap-parametrico-.html"><a href="inferencia-grafica-tamano-de-muestra-bootstrap-parametrico-.html"><i class="fa fa-check"></i>9-Inferencia gráfica, tamaño de muestra, bootstrap paramétrico.</a><ul>
<li class="chapter" data-level="" data-path="inferencia-grafica-tamano-de-muestra-bootstrap-parametrico-.html"><a href="inferencia-grafica-tamano-de-muestra-bootstrap-parametrico-.html#solucion-2"><i class="fa fa-check"></i>Solución</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="familias-conjugadas.html"><a href="familias-conjugadas.html"><i class="fa fa-check"></i>10-Familias conjugadas</a></li>
<li class="chapter" data-level="" data-path="metropolis-2.html"><a href="metropolis-2.html"><i class="fa fa-check"></i>11-Metropolis</a><ul>
<li class="chapter" data-level="" data-path="metropolis-2.html"><a href="metropolis-2.html#solucion-3"><i class="fa fa-check"></i>Solución</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mcmc-convergencia.html"><a href="mcmc-convergencia.html"><i class="fa fa-check"></i>12-MCMC convergencia</a></li>
<li class="chapter" data-level="" data-path="modelos-jerarquicos-1.html"><a href="modelos-jerarquicos-1.html"><i class="fa fa-check"></i>13-Modelos jerárquicos</a><ul>
<li class="chapter" data-level="" data-path="modelos-jerarquicos-1.html"><a href="modelos-jerarquicos-1.html#inferencia-grafica-1"><i class="fa fa-check"></i>1. Inferencia gráfica</a></li>
<li class="chapter" data-level="10.12.1" data-path="modelos-jerarquicos-1.html"><a href="modelos-jerarquicos-1.html#simulacion-para-el-calculo-de-tamanos-de-muestra"><i class="fa fa-check"></i><b>10.12.1</b> 2. Simulación para el cálculo de tamaños de muestra</a></li>
<li class="chapter" data-level="" data-path="modelos-jerarquicos-1.html"><a href="modelos-jerarquicos-1.html#mcmc-1"><i class="fa fa-check"></i>3. MCMC</a></li>
<li class="chapter" data-level="" data-path="modelos-jerarquicos-1.html"><a href="modelos-jerarquicos-1.html#modelos-jerarquicos-y-evaluacion-de-ajuste"><i class="fa fa-check"></i>4. Modelos jerárquicos y evaluación de ajuste</a></li>
<li class="chapter" data-level="10.12.2" data-path="modelos-jerarquicos-1.html"><a href="modelos-jerarquicos-1.html#implementacion-1"><i class="fa fa-check"></i><b>10.12.2</b> Implementación</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estadística Computacional</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelos-jerarquicos-1" class="section level2 unnumbered">
<h2>13-Modelos jerárquicos</h2>
<p>En este ejercicio definirás un modelo jerárquico para la incidencia de tumores
en grupos de conejos a los que se suministró una medicina. Se realizaron 71
experimentos distintos utilizando la misma medicina.</p>
<p>Considerando que cada conejo proviene de un experimento distinto, se desea
estudiar <span class="math inline">\(\theta_j\)</span>, la probabilidad de desarrollar un tumor en el
<span class="math inline">\(j\)</span>-ésimo grupo, este parámetro variará de grupo a grupo.</p>
<p>Denotaremos <span class="math inline">\(y_{ij}\)</span> la observación en el <span class="math inline">\(i\)</span>-ésimo conejo perteneciente al
<span class="math inline">\(j\)</span>-ésimo experimento, <span class="math inline">\(y_{ij}\)</span> puede tomar dos valores: 1 indicando que el
conejo desarrolló tumor y 0 en el caso contrario, por tanto la verosimilitud
sería:</p>
<p><span class="math display">\[y_{ij} \sim Bernoulli(\theta_j)\]</span></p>
<p>Adicionalmente se desea estimar el efecto medio de la medicina a lo largo de
los grupos <span class="math inline">\(\mu\)</span>, por lo que utilizaremos un modelo jerárquico como sigue:</p>
<p><span class="math display">\[\theta_j \sim Beta(a, b)\]</span></p>
<p>donde</p>
<p><span class="math display">\[a=\mu \kappa\]</span>
<span class="math display">\[b=(1-\mu)\kappa\]</span></p>
<p>Finalmente asignamos una distribución a los hiperparámetros <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\kappa\)</span>,</p>
<p><span class="math display">\[\mu \sim Beta(A_{\mu}, B_{\mu})\]</span></p>
<p><span class="math display">\[\kappa \sim Gamma(S_{\kappa}, R_{\kappa})\]</span></p>
<ol style="list-style-type: decimal">
<li><p>Si piensas en este problema como un lanzamiento de monedas, ¿a qué
corresponden las monedas y los lanzamientos?</p></li>
<li>Los datos en el archivo <code>rabbits.RData</code> contienen las observaciones de los
71 experimentos,
cada renglón corresponde a una observación.
<ul>
<li>Utiliza JAGS o Stan para ajustar un modelo jerárquico como el descrito
arriba y usando una inicial <span class="math inline">\(Beta(1, 1)\)</span> y una <span class="math inline">\(Gamma(1, 0.1)\)</span> para <span class="math inline">\(\mu\)</span> y
<span class="math inline">\(\kappa\)</span> respectivamente.</li>
<li>Realiza un histograma de la distribución posterior de <span class="math inline">\(\mu\)</span>, <span class="math inline">\(\kappa\)</span>.
Comenta tus resultados.</li>
</ul></li>
<li>Ajusta un nuevo modelo utilizando una iniciales <span class="math inline">\(Beta(10, 10)\)</span> y
<span class="math inline">\(Gamma(0.51, 0.01)\)</span> para <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\kappa\)</span> (lo demás quedará igual).
<ul>
<li>Realiza una gráfica con las medias posteriores de los parámetros
<span class="math inline">\(\theta_j\)</span> bajo los dos escenarios de distribuciones iniciales: en el eje
horizontal grafica las medias posteriores del modelo ajustado en el paso
anterior y en el eje vertical las medias posteriores del segundo modelo .
¿Cómo se comparan? ¿A qué se deben las diferencias?</li>
</ul></li>
</ol>
<p>## Final {-}</p>
<ul>
<li><p>Puede realizarse individual o en parejas.</p></li>
<li><p>Enviar por correo electónico documento final (no Rmd).</p></li>
<li><p>Entregar <strong>sábado 8 antes de las 20:00 hr</strong>, después de eso se califica sobre
7 (máximo entregar domingo a las 13:00 hrs).</p></li>
<li><p>Incluir código y respuestas que describan lo que se hizo.</p></li>
<li><p>Dudas y artículo para pregunta 3 <a href="https://drive.google.com/open?id=1IadZgMhrTAsll8YLLwcnBhk17UcwOdtK">aquí</a>.</p></li>
</ul>
<div id="inferencia-grafica-1" class="section level3 unnumbered">
<h3>1. Inferencia gráfica</h3>
<p>Para este ejercicio utilizaremos los datos de un estudio
longitudinal de <em>Singer y Willet 2003</em> (wages). En este estudio se visitó a
hombres en edad laboral que habitan en EUA, se visitó a cada sujeto entre 1 y 13
veces, en cada visita se registraron las siguientes mediciones:</p>
<pre><code>id: identificador de sujeto  
hgc: grado de educación más alto completado  
lnw : logaritmo natural del salario  
exper: años de experiencia laboral  </code></pre>
<p>El objetivo del ejercicio es estudiar la relación entre salario y experiencia
laboral por raza para aquellos sujetos cuyo año máximo de estudios completados
es igual a 9, 10 u 11, estos son sujetos que abandonaron sus estudios durante
preparatoria. Seguiremos un enfoque no paramétrico que consiste en ajustar un
suavizador para cada grupo de raza (blanco, hispano o negro) como se muestra
en la siguiente gráfica.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&quot;data/wages_t.RData&quot;</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(wages_t, <span class="kw">aes</span>(<span class="dt">x =</span> exper, <span class="dt">y =</span> lnw)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.25</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">group =</span> race, <span class="dt">color =</span> race), <span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) </code></pre>
<p>Utilizaremos una prueba de hipótesis gráfica para determinar si existe una
diferencia significativa entre las curvas.</p>
<ol style="list-style-type: decimal">
<li><strong>Preparación de los datos</strong>.</li>
</ol>
<ul>
<li><p>Selecciona los sujetos con grado de estudios completado igual a 9, 10 u 11.</p></li>
<li><p>Elimina las observaciones donde el logaritmo del salario (lnw) es mayor a 3.5.</p></li>
<li><p>Crea una variable correspondiente a raza, un sujeto es de raza hispana si
la variable hispanic toma el valor 1, de raza negra si la variable black
toma el valor 1 y de raza blanca si las dos anteriores son cero.</p></li>
<li><p>Crea un subconjunto de la base de datos de tal manera que tengas el mismo
número de sujetos distintos en cada grupo de raza. Nota: habrá el mismo número
de sujetos en cada grupo pero el número de observaciones puede diferir pues los
sujetos fueron visitados un número distinto de veces.</p></li>
</ul>
<p>2 <strong>Prueba de hipótesis visual</strong></p>
<ul>
<li><p>El escenario nulo consiste en que no hay diferencia entre las razas. Para
generar los datos nulos, la etiqueta de raza de cada sujeto se permuta,
es decir, se reasigna la raza de cada sujeto de manera aleatoria (para todas las
mediciones de un sujeto dado se reasigna una misma raza). Genera 10 conjuntos de
datos nulos y para cada uno ajusta una curva <em>loess</em> siguiendo la instrucción de
la gráfica de arriba. Crea una gráfica de paneles donde incluyas los 10
conjuntos nulos y los datos reales, estos últimos estarán escondidos de manera
aleatoria.</p></li>
<li><p>Realiza la siguiente pregunta a una o más personas <strong>que no tomen la clase</strong>:</p></li>
</ul>
<p><em>Las siguientes 10 gráficas muestran suavizamientos de log(salarios) por años
de experiencia laboral. Una de ellas usa datos reales y las otras 9 son datos
nulos, generados bajo el supuesto de que no existe diferencia entre los
subgrupos. ¿Cuál es la gráfica más distinta?</em></p>
<p>Reporta si las personas cuestionadas pudieron distinguir los datos.</p>
<ul>
<li><p>¿Cuál es tu conclusión de la prueba de hipótesis visual?</p></li>
<li><p>¿A cuántas personas preguntaste y cuál es el valor p de la prueba?</p></li>
</ul>
</div>
<div id="simulacion-para-el-calculo-de-tamanos-de-muestra" class="section level3">
<h3><span class="header-section-number">10.12.1</span> 2. Simulación para el cálculo de tamaños de muestra</h3>
<p>En el conteo rápido del estado de Guanajuato, se calculó el tamaño de muestra
fijando como objetivo que los intervalos del <span class="math inline">\(95\)</span>% de confianza tuvieran una
longitud máxima de 2 puntos porcentuales para todos los candidatos. En este
ejercicio calcularás el tamaño de muestra mínimo que cumpla con el objetivo
usando 3 diseños de muestreo distintos: 1) muestreo aleatorio simple (MAS),
2) estratificando con distrito local y 3) estratificando con distrito federal.</p>
<p>Utilizarás simulación y los resultados de las elecciones de gobernador
correspondientes al 2012.</p>
<pre class="sourceCode r"><code class="sourceCode r">gto_<span class="dv">2012</span> &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/gto_2012.csv&quot;</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</code></pre>
<p>En el caso de <strong>MAS</strong>, para cada tamaño de muestra
<span class="math inline">\(n=50,100,200,300,400,500,600,700\)</span>:</p>
<ol style="list-style-type: lower-roman">
<li><p>Simula una muestra aleatoria de tamaño <span class="math inline">\(n\)</span>.</p></li>
<li><p>Calcula el estimador de razón (correspondiente a muestreo aleatorio simple)
para cada candidato:</p></li>
</ol>
<p><span class="math display">\[\hat{p}=\frac{\sum_{i} Y_{i}}{\sum_i X_{i}}\]</span>
<span class="math display">\[\hat{p}=\frac{\sum_h \frac{N_h}{n_h} \sum_i Y_{hi}}{\sum_h \frac{N_h}{n_h} \sum_i X_{hi}}\]</span>
donde:</p>
<ul>
<li><p><span class="math inline">\(\hat{p}\)</span> es la estimación de la proporción de votos que recibió el candidato
en la elección.</p></li>
<li><p><span class="math inline">\(Y_{i}\)</span> es el número total de votos que recibió el candidato
en la <span class="math inline">\(i\)</span>-ésima casilla.</p></li>
<li><p><span class="math inline">\(X_{i}\)</span> es el número total de votos en la <span class="math inline">\(i\)</span>-ésima casilla.</p></li>
</ul>
<ol start="3" style="list-style-type: lower-roman">
<li>Repite los pasos i y ii <span class="math inline">\(1000\)</span> veces para estimar el error estándar para
una muestra de tamaño <span class="math inline">\(n\)</span>.</li>
</ol>
<p>Para cada posible <strong>estratificación</strong> (<code>distrito_fed_17</code> y <code>distrito_loc_17</code>) y
tamaño de muestra <span class="math inline">\(n=50,100,200,300,400,500,600,700\)</span>:</p>
<ol style="list-style-type: lower-roman">
<li>Simula una muestra estratificada de tamaño <span class="math inline">\(n\)</span>, donde el tamaño de muestra en
cada estrato se asigna proporcional al tamaño del estrato, esto es, sea <span class="math inline">\(N_h\)</span> el
número de casillas en el <span class="math inline">\(h\)</span>-ésimo estrato, entonces para el estrato <span class="math inline">\(h\)</span> el
número de casillas en la muestra será:
<span class="math display">\[n_h = N_h \cdot \frac{n}{\sum_j N_j}\]</span></li>
<li>Calcula el estimador de razón combinado (correspondiente a muestreo
estratificado) para cada candidato:</li>
</ol>
<p><span class="math display">\[\hat{p}=\frac{\sum_h \frac{N_h}{n_h} \sum_i Y_{hi}}{\sum_h \frac{N_h}{n_h} \sum_i X_{hi}}\]</span></p>
<p>donde:</p>
<ul>
<li><p><span class="math inline">\(\hat{p}\)</span> es la estimación de la proporción de votos que recibió el candidato
en la elección.</p></li>
<li><p><span class="math inline">\(Y_{hi}\)</span> es el número total de votos que recibió el candidato
en la <span class="math inline">\(i\)</span>-ésima casillas, que pertence al <span class="math inline">\(h\)</span>-ésimo estrato.</p></li>
<li><p><span class="math inline">\(X_{hi}\)</span> es el número total de votos en la <span class="math inline">\(i\)</span>-ésima casilla, que pertence al
<span class="math inline">\(h\)</span>-ésimo estrato.</p></li>
<li><p><span class="math inline">\(N_h\)</span> es el número total de casillas en el <span class="math inline">\(h\)</span>-ésimo estrato.</p></li>
<li><p><span class="math inline">\(n_h\)</span> es el número de casillas del <span class="math inline">\(h\)</span>-ésimo estrato que se seleccionaron en
la muestra.</p></li>
</ul>
<ol start="3" style="list-style-type: lower-roman">
<li>Repite los pasos i y ii <span class="math inline">\(1000\)</span> veces para estimar el error estándar para
una muestra de tamaño <span class="math inline">\(n\)</span>.</li>
</ol>
<p>Ahora:</p>
<ol style="list-style-type: decimal">
<li><p>Reporta en una tabla el error estándar para cada candidato, tamaño de muestra
y diseño (MAS/estratificaciones).</p></li>
<li><p>Grafica los datos de la tabla: realiza una gráfica de paneles (con
<code>facet_wrap()</code>), cada partido en un panel, en el eje horizontal grafica el
tamaño de muestra y en el eje vertical el error estándar, tendrás en una misma
gráfica tres curvas, una para muestreo aleatorio simple y una para
cada estratificación.</p></li>
<li><p>¿Qué diseño y tamaño de muestra elegirías? Explica tu respuesta y de
ser necesario repite los pasos i-iii para otros valores de <span class="math inline">\(n\)</span>.</p></li>
</ol>
</div>
<div id="mcmc-1" class="section level3 unnumbered">
<h3>3. MCMC</h3>
<p>Siguiendo con el conteo rápido de Guanajuato, calcularás intervalos de confianza
usando el modelo propuesto en <span class="citation">Mendoza and Nieto-Barajas (<a href="#ref-mendoza2016">2016</a>)</span>.</p>
<p>Los autores proponen ajustar un modelo de manera independiente para cada
candidato en cada estrato:</p>
<ul>
<li>Verosimilitud</li>
</ul>
<p><span class="math display">\[X_{ij}^k\big|\theta_{ij},\tau_{ij}\sim N\bigg(n_i^k\theta_{ij}, \frac{\tau_{ij}}{n_i^k}\bigg)\]</span></p>
<p>para <span class="math inline">\(k=1,...,c_i\)</span>, <span class="math inline">\(i = 1,...,N\)</span>, <span class="math inline">\(j=1,...,J\)</span></p>
<ul>
<li>Iniciales</li>
</ul>
<p><span class="math display">\[p(\theta_{i,j},\tau_{ij})\propto \tau_{ij}^{-1}I(\tau_{ij}&gt;0)I(0&lt;\theta_{i,j}&lt;1)\]</span></p>
<ul>
<li>Posterior</li>
</ul>
<p><span class="math display">\[p(\theta_{ij}, \tau_{ij}|X_{ij}) \sim N\bigg(\theta_{ij} \bigg| \frac{\sum_{k=1}^{c_i}x_{ij}^k}{\sum_{k=1}^{c_i}n_{i}^k}, \tau_{ij}\sum_{k=1}^{c_i}n_i^k\bigg)I(0&lt;\theta_{ij}&lt;1)\times Ga\bigg(\tau_{ij}\bigg|\frac{c_i-1}{2}, \frac{1}{2}\bigg[\sum_{k=1}^{c_i}\frac{(x_{ij}^k)^2}{n_i^k}-\frac{\big(\sum_{k=1}^{c_i}x_{ij}^k\big)^2}{\sum_{k=1}^{c_i}n_i^k}\bigg]\bigg)\]</span>
donde:</p>
<ul>
<li><p><span class="math inline">\(X_{ij}\)</span> número de personas que favorecen al candidato <span class="math inline">\(j\)</span> en el estrato <span class="math inline">\(i\)</span>.</p></li>
<li><p><span class="math inline">\(X_{ij}^k\)</span> número de personas que favorecen al candidato <span class="math inline">\(j\)</span> en la casilla <span class="math inline">\(k\)</span>
del estrato <span class="math inline">\(i\)</span>.</p></li>
<li><p><span class="math inline">\(n_i^k\)</span> tamaño de la lista nominal en la <span class="math inline">\(k\)</span>-ésima casilla del <span class="math inline">\(i\)</span>-ésimo
estrato.</p></li>
<li><p><span class="math inline">\(\tau_{ij}/n_i^{k}\)</span> es la precisión para cada candidato.</p></li>
<li><p><span class="math inline">\(\theta_{ij}\)</span> es la proporción de las personas en la lista nominal del estrato
<span class="math inline">\(i\)</span> que favorecen al <span class="math inline">\(j\)</span>-ésimo partido.</p></li>
<li><p><span class="math inline">\(c_i\)</span> número de casillas del <span class="math inline">\(i\)</span>-ésimo estrato en la muestra.</p></li>
</ul>
<p>Los detalles del modelo los puedes encontrar en el <a href="https://drive.google.com/open?id=1lI5lUSqNcIYvlvxRyrbBD_IrzlWIzILY">artículo</a>.</p>
<p>Implementa el modelo y estima los resultados electorales de Guanajuato con la
muestra:</p>
<pre class="sourceCode r"><code class="sourceCode r">gto_muestra &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/muestra_gto_2012.csv&quot;</span>)</code></pre>
<p>Reporta estimaciones puntuales (media posterior) e intervalos del 95% de
credibilidad para cada candidato</p>
</div>
<div id="modelos-jerarquicos-y-evaluacion-de-ajuste" class="section level3 unnumbered">
<h3>4. Modelos jerárquicos y evaluación de ajuste</h3>
<p><strong>Postestratificación</strong> es un método estándar que se utiliza para corregir las
estimaciones obtenidas de muestreo probabilístico cuando hay distintas
probabilidades de selección y para corregir no respuesta. A grandes rasgos, se
divide la población en categorías y se estima la distribución de las respuestas
en cada categoría, después se pondera cada categoría de acuerdo a su tamaño en
la población. Típicamente las categorías se crean con variables demográficas
(sexo, edad, …).</p>
<p>La dificultad que suele surgir en el proceso de postestratificación es que
por una parte se desea crear las celdas lo más finas posible, considerando
el cruce de muchas variables, con el objetivo de corregir en mayor medida
posibles sesgos en las estimaciones; sin embargo, conforme aumenta el número de
celdas el número de respondentes en cada una disminuye (muchas incluso quedan
vacías) y esto conlleva a que las estimaciones dentro de cada celda sean poco
precisas. Ante esta dificultad, la propuesta de MRP es modelar las respuestas
condicional a las variables de postestratificación, cuando las categorías de la
postestratificación siguen de manera natural estructuras jerárquicas (como
hogares en estados) se puede mejorar la eficiencia de la estimación ajustando
modelos multinivel.</p>
<p>Es así que MRP es una extensión a los ajustes de postestratificación clásicos
que permite usar más categorías y por tanto información más detallada de la
población. Una ventaja adicional es que además hace posible estimar la respuesta
en subcategorias demográficas o geográficas. En este ejercicio reproduciremos
el modelo que se ajusta en <span class="citation">Park, Gelman, and Bafumi (<a href="#ref-parkgelmanbafumi">2004</a>)</span> lo puedes descargar de <a href="http://www.stat.columbia.edu/~gelman/research/published/parkgelmanbafumi.pdf">esta liga</a>.</p>
<p>En esta aplicación se utilizan encuestas de opinión pública en EUA, en
particular modelamos la probabilidad de que un respondente prefiera al
candidato Republicano como presidente y usando los datos de encuestas de
<em>CBS News</em> levantadas previo a la elección presidencial de 1988.</p>
<p>Las variables demográficas que determinan las celdas de postestratificación son:
sexo, raza negra, edad (categórica), grado educativo y estado, si construyéramos
las celdas de postestratificación quedarían,</p>
<p>sexo(2) x raza negra(2) x edad(4) x educación(4) x estado(52) = 3264</p>
<p>celdas y tenemos únicamente 2193 entrevistas, por lo que un enfoque clásico
utilizando todas las variables demográficas disponibles queda descartado.</p>
<p>Ahora, definimos el modelo multinivel a usar, usaremos regresión logística
multinivel, en este planteamiento la variable <span class="math inline">\(y_i\)</span> indica si la
<span class="math inline">\(i\)</span>-ésima persona apoyaba al candidato republicano o no, y se agregan todas las
variables demográficas como covariables.</p>
<p><span class="math display">\[
\begin{aligned}
  P(y_i = 1) &amp;= logit^{-1}(\beta^0 + \beta^{mujer}\cdot mujer_i + \beta^{neg}\cdot neg_i+\beta^{mujer, neg}\cdot mujer_i \cdot neg_i+ \\
  &amp; \beta_{edad(i)}^{edad} +  \beta_{edad(i), edu(i)}^{edad,edu} + 
 \beta_{estado(i)}^{estado})
\end{aligned}
\]</span></p>
<p>En este ejemplo la estructura multinivel se reduce al coeficiente de
estado que se modela con indicadoras de región y una medida del apoyo
Republicano en el estado reportado en la elección previa.</p>
<p><span class="math display">\[ \beta_{j}\sim N(\beta_{region(j)}^{region}+\beta^{vprev}\cdot vprev_j, \sigma^2_{estado})\]</span></p>
<p>Ajustaremos este modelo usando el programa JAGS (Just Another Gibbs Sampler), y
utilizamos las estimaciones para hacer predicciones a nivel estado (<span class="math inline">\(\theta_s\)</span>):</p>
<p><span class="math display">\[\theta_s=\frac{\sum_{j \in s}N_{j}\pi_j}{\sum_{j \in s}N_{j}}\]</span></p>
<p>donde <span class="math inline">\(N_j\)</span> indica el número de individuos en cada estado que
pertenecen a la <span class="math inline">\(j\)</span>-ésima celda, la información para determinar las <span class="math inline">\(N_j\)</span> se
obtendrá del censo de población.</p>
</div>
<div id="implementacion-1" class="section level3">
<h3><span class="header-section-number">10.12.2</span> Implementación</h3>
<p>Datos en <a href="http://www.stat.columbia.edu/~gelman/arm/examples/election88/">election88</a>,
o en la carpeta data.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># preparación de los datos</span>
<span class="kw">library</span>(haven)
<span class="co"># datos de encuestas</span>
polls &lt;-<span class="st"> </span><span class="kw">read_dta</span>(<span class="st">&quot;data/polls.dta&quot;</span>)
<span class="co"># nos quedamos con la última encuesta y eliminamos faltantes</span>
last_poll &lt;-<span class="st"> </span>polls <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">filter</span>(survey <span class="op">==</span><span class="st"> </span><span class="dv">8</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">na.omit</span>()

<span class="co"># datos de elecciones pasadas para utilizar como covariable y variable región</span>
presvote &lt;-<span class="st"> </span><span class="kw">read_dta</span>(<span class="st">&quot;data/presvote.dta&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">cbind</span>(<span class="dt">region =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">4</span>,
        <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>))</code></pre>
<p>Los datos para el modelo serán:</p>
<pre class="sourceCode r"><code class="sourceCode r">data_jags &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">n =</span> <span class="kw">nrow</span>(last_poll), 
    <span class="dt">n_region =</span> <span class="dv">5</span>, 
    <span class="dt">n_age =</span> <span class="kw">n_distinct</span>(last_poll<span class="op">$</span>age), 
    <span class="dt">n_edu =</span> <span class="kw">n_distinct</span>(last_poll<span class="op">$</span>edu), 
    <span class="dt">n_state =</span> <span class="kw">max</span>(last_poll<span class="op">$</span>state), 
    <span class="dt">y =</span> last_poll<span class="op">$</span>bush, 
    <span class="dt">female =</span> last_poll<span class="op">$</span>female,
    <span class="dt">edu =</span> last_poll<span class="op">$</span>edu,
    <span class="dt">age =</span> last_poll<span class="op">$</span>age,
    <span class="dt">black =</span> last_poll<span class="op">$</span>black,
    <span class="dt">state =</span> last_poll<span class="op">$</span>state, 
    <span class="dt">v_prev =</span> presvote<span class="op">$</span>g76_84pr,
    <span class="dt">region =</span> presvote<span class="op">$</span>region
)</code></pre>
<p>Y el código en JAGS:</p>
<pre class="sourceCode r"><code class="sourceCode r">model_mrp &lt;-<span class="st"> &quot;</span>
<span class="st">    model {</span>
<span class="st">        for (i in 1:n){</span>
<span class="st">            y[i] ~ dbern(p_bound[i])</span>
<span class="st">            p_bound[i] &lt;- max(0, p[i])</span>
<span class="st">            p[i] &lt;- ilogit(b_0 + b_female*female[i] + b_black * black[i] +</span>
<span class="st">                b_female_black * female[i]*black[i] +</span>
<span class="st">                a_age[age[i]] + a_edu[edu[i]] + a_age_edu[age[i],edu[i]] +</span>
<span class="st">                a_state[state[i]])</span>
<span class="st">    }</span>
<span class="st">    b_0 ~ dnorm (0, .0001)</span>
<span class="st">    b_female ~ dnorm (0, .0001)</span>
<span class="st">    b_black ~ dnorm (0, .0001)</span>
<span class="st">    b_female_black ~ dnorm (0, .0001)</span>

<span class="st">    for (j in 1:n_age) {</span>
<span class="st">        a_age[j] ~ dnorm(0, tau_age)}</span>
<span class="st">    for (j in 1:n_edu) {</span>
<span class="st">        a_edu[j] ~ dnorm(0, tau_edu)}</span>
<span class="st">    for (j in 1:n_age) {</span>
<span class="st">        for (k in 1:n_edu){</span>
<span class="st">            a_age_edu[j,k] ~ dnorm(0, tau_age_edu)</span>
<span class="st">        }</span>
<span class="st">    }</span>
<span class="st">    for (j in 1:n_state) {</span>
<span class="st">        a_state[j] ~ dnorm(a_state_hat[j], tau_state)</span>
<span class="st">        a_state_hat[j] &lt;- a_region[region[j]] + b_v_prev*v_prev[j]</span>
<span class="st">    }</span>
<span class="st">    b_v_prev ~ dnorm (0, .0001) </span>
<span class="st">    for (j in 1:n_region) {</span>
<span class="st">        a_region[j] ~ dnorm(0, tau_region)</span>
<span class="st">    }</span>
<span class="st">    tau_age &lt;- pow(sigma_age, -2)</span>
<span class="st">    tau_edu &lt;- pow(sigma_edu, -2)</span>
<span class="st">    tau_age_edu &lt;- pow(sigma_age_edu, -2)</span>
<span class="st">    tau_state &lt;- pow(sigma_state, -2)</span>
<span class="st">    tau_region &lt;- pow(sigma_region, -2)</span>
<span class="st">    sigma_age ~ dunif (0, 100)</span>
<span class="st">    sigma_edu ~ dunif (0, 100)</span>
<span class="st">    sigma_age_edu ~ dunif (0, 100)</span>
<span class="st">    sigma_state ~ dunif (0, 100)</span>
<span class="st">    sigma_region ~ dunif (0, 100)</span>
<span class="st">    }</span>
<span class="st">    &quot;</span>
<span class="kw">cat</span>(model_mrp, <span class="dt">file =</span> <span class="st">&#39;model_mrp.bugs&#39;</span>)</code></pre>
<ol style="list-style-type: decimal">
<li><p><strong>Modelo</strong>. Ajusta el modelo y revisa convergencia, describe
cuantas cadenas, iteraciones y etapa de calentamiento elegiste, además
escribe como determinaste convergencia.</p></li>
<li><p><strong>Evaluación de ajuste</strong>. Usaremos la distribución predictiva posterior para
simular del modelo y comparar con los datos observados. En particular veremos
como se comparan las simulaciones del modelo por estado, la gráfica con los
datos será la que sigue:</p></li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r">bush_state &lt;-<span class="st"> </span>last_poll <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">group_by</span>(state) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">summarise</span>(<span class="dt">prop =</span> <span class="kw">mean</span>(bush, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">state_ord =</span> <span class="kw">as.numeric</span>(<span class="kw">reorder</span>(state, prop)))

<span class="kw">ggplot</span>(bush_state, <span class="kw">aes</span>(<span class="dt">x =</span> state_ord, <span class="dt">y =</span> prop)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>()</code></pre>
<p>Debes simular del modelo 10 conjutos de datos del tamaño de los originales
(replicaciones de los datos) y hacer una gráfica de páneles donde muestres los
datos originales y las replicaciones, ¿que concluyes al ver la gráfica?</p>
<ol start="3" style="list-style-type: decimal">
<li>El siguiente código predice para cada celda de la tabla del censo, vale la
pena notar, que para cada celda tenemos una lista en el vector <code>pred</code> con las
simuaciones que le corresponden.</li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r"> <span class="co"># construct the n.sims x 3264 matrix</span>
census88 &lt;-<span class="st"> </span><span class="kw">read_dta</span>(<span class="st">&quot;data/census88.dta&quot;</span>)
<span class="kw">glimpse</span>(census88)

coef_sims &lt;-<span class="st"> </span>mrp<span class="op">$</span>BUGSoutput<span class="op">$</span>sims.matrix

pred_cell &lt;-<span class="st"> </span>census88 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(
        <span class="dt">pred =</span> <span class="kw">list</span>(arm<span class="op">::</span><span class="kw">invlogit</span>(coef_sims[, <span class="st">&quot;b_0&quot;</span>] <span class="op">+</span><span class="st"> </span>
<span class="st">            </span>coef_sims[, <span class="st">&quot;b_female&quot;</span>] <span class="op">*</span><span class="st"> </span>female <span class="op">+</span>
<span class="st">            </span>coef_sims[, <span class="st">&quot;b_black&quot;</span>] <span class="op">*</span><span class="st"> </span>black <span class="op">+</span><span class="st"> </span>
<span class="st">            </span>coef_sims[, <span class="st">&quot;b_female_black&quot;</span>] <span class="op">*</span><span class="st"> </span>female <span class="op">*</span><span class="st"> </span>black <span class="op">+</span>
<span class="st">            </span>coef_sims[, <span class="kw">str_c</span>(<span class="st">&quot;a_age[&quot;</span>, <span class="kw">round</span>(age), <span class="st">&quot;]&quot;</span>)] <span class="op">+</span>
<span class="st">            </span>coef_sims[, <span class="kw">str_c</span>(<span class="st">&quot;a_edu[&quot;</span>, <span class="kw">round</span>(edu), <span class="st">&quot;]&quot;</span>)] <span class="op">+</span><span class="st">  </span>
<span class="st">            </span>coef_sims[, <span class="kw">str_c</span>(<span class="st">&quot;a_age_edu[&quot;</span>, <span class="kw">round</span>(age), <span class="st">&quot;,&quot;</span>, <span class="kw">round</span>(edu), <span class="st">&quot;]&quot;</span>)] <span class="op">+</span><span class="st">  </span>
<span class="st">            </span>coef_sims[, <span class="kw">str_c</span>(<span class="st">&quot;a_state[&quot;</span>, <span class="kw">round</span>(state), <span class="st">&quot;]&quot;</span>)]))
        ) </code></pre>
<p>Para hacer las estimaciones por estado hace falta ponderar por el número de
casos en cada celda:</p>
<p><span class="math display">\[\theta_s=\frac{\sum_{j \in s}N_{j}\pi_j}{\sum_{j \in s}N_{j}}\]</span></p>
<ol start="4" style="list-style-type: decimal">
<li>Genera las simulaciones de <span class="math inline">\(\theta_s\)</span>, recuerda que debarás calcular una
simulación de cada <span class="math inline">\(\theta_s\)</span> por cada simulación de <span class="math inline">\(\pi__j\)</span> obtenida con el
código de arriba. Realiza una gráfica con intervalos de credibilidad del 95%
para cada <span class="math inline">\(theta_s\)</span>.</li>
</ol>

</div>
</div>
<!-- </div> -->
<h3>Referencias</h3>
<div id="refs" class="references">
<div id="ref-mendoza2016">
<p>Mendoza, Manuel, and Luis E. Nieto-Barajas. 2016. “Quick Counts in the Mexican Presidential Elections: A Bayesian Approach.” <em>Electoral Studies</em> 43 (C):124–32. <a href="https://doi.org/10.1016/j.electstud.2016.06.007" class="uri">https://doi.org/10.1016/j.electstud.2016.06.007</a>.</p>
</div>
<div id="ref-parkgelmanbafumi">
<p>Park, David K., Andrew Gelman, and Joseph Bafumi. 2004. “Bayesian Multilevel Estimation with Poststratification: State-Level Estimates from National Polls.” <em>Political Analysis</em> 12 (04):375–85. <a href="https://EconPapers.repec.org/RePEc:cup:polals:v:12:y:2004:i:04:p:375-385_00" class="uri">https://EconPapers.repec.org/RePEc:cup:polals:v:12:y:2004:i:04:p:375-385_00</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mcmc-convergencia.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="referencias.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tereom/est-computacional-2018/edit/master/98-tareas.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["est-computacional-2018.pdf", "est-computacional-2018.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
